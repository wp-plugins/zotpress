jQuery(document).ready(function(){if(jQuery(".zp-Zotpress-SearchBox").length>0){var e=!0,t=1,r="",a="",n=zpShortcodeAJAX.ajaxurl+"?action=zpRetrieveViaShortcode&zpShortcode_nonce="+zpShortcodeAJAX.zpShortcode_nonce,u=!1;jQuery(".ZP_SHOWTAGS").length>0&&"1"==parseInt(jQuery(".ZP_SHOWTAGS").text())&&(u=!0);var o=!1;function s(e,t,r){void 0!==e&&"false"!=e&&""!=e||(e=!1),void 0!==t&&"false"!=t&&""!=t||(t=!1),void 0!==r&&"false"!=r&&""!=r||(r=!1),a="",a+="&api_user_id="+jQuery(".ZOTPRESS_USER").val(),a+="&item_type=items",a+="&downloadable="+jQuery(".ZOTPRESS_AC_DOWNLOAD").val(),a+="&style="+jQuery(".ZP_STYLE").text(),a+="&sortby="+jQuery(".ZP_SORTBY").text(),a+="&order="+jQuery(".ZP_ORDER").text(),a+="&citeable="+jQuery(".ZOTPRESS_AC_CITE").val(),jQuery(".ZOTPRESS_AC_MAXRESULTS").val().length>0&&(a+="&maxresults="+jQuery(".ZOTPRESS_AC_MAXRESULTS").val()),u&&(a+="&showtags=true"),o&&(a+="&showimage=true"),t&&(a+="&request_start="+t),r&&(a+="&request_last="+r),a+="&update=true",e?a+="&filter="+e:jQuery("input[name=zpSearchFilters]").length>0&&(a+="&filter="+jQuery("input[name=zpSearchFilters]:checked").val())}jQuery(".ZOTPRESS_AC_IMAGES").length>0&&(o=!0),s(!1,!1,!1),jQuery("input[name='zpSearchFilters']").click(function(){jQuery("input[name=zpSearchFilters]").length>0&&s(jQuery(this).val(),!1,!1),jQuery("input.zp-Zotpress-SearchBox-Input").autocomplete("option","source",n+a),jQuery("input.zp-Zotpress-SearchBox-Input").val().length>0&&jQuery("input.zp-Zotpress-SearchBox-Input").val()!=zpShortcodeAJAX.txt_typetosearch&&jQuery("input.zp-Zotpress-SearchBox-Input").autocomplete("search")}),jQuery("input.zp-Zotpress-SearchBox-Input").bind("keydown",function(e){e.keyCode===jQuery.ui.keyCode.TAB&&jQuery(this).data("autocomplete").menu.active&&e.preventDefault(),13===e.keyCode&&e.preventDefault()}).bind("focus",function(e){jQuery(this).val()==zpShortcodeAJAX.txt_typetosearch&&(jQuery(this).val(""),jQuery(this).removeClass("help"))}).bind("blur",function(e){""==jQuery.trim(jQuery(this).val())&&(jQuery(this).val(zpShortcodeAJAX.txt_typetosearch),jQuery(this).addClass("help"))}).autocomplete({source:n+a,minLength:jQuery(".ZOTPRESS_AC_MINLENGTH").val(),focus:function(){return!1},search:function(u,o){var p=!1;u.hasOwnProperty("currentTarget")&&(p=u.currentTarget.value),t=1,(1==e||p&&p!=r)&&(jQuery(".zp-List .zpSearchLoading").addClass("show"),jQuery(".zpSearchResultsPaging").length>0&&(jQuery(".zpSearchResultsPaging").empty(),jQuery(".zpSearchResultsPagingContainer").hide()),jQuery(".zpSearchResultsContainer").empty(),s(!1,0,!1),jQuery("input.zp-Zotpress-SearchBox-Input").autocomplete("option","source",n+a),window.zpPage=1,1==e&&p&&(r=p))},response:function(r,p){jQuery(".zp-List .zpSearchLoading").removeClass("show"),"0"==p.content||"empty"==p.content[0].label?(jQuery(".zpSearchResultsPaging").length>0&&(jQuery(".zpSearchResultsPaging").empty(),jQuery(".zpSearchResultsPagingContainer").hide()),jQuery(".zpSearchResultsContainer").append("<p>No items found.</p>\n")):(jQuery.each(p.content[3],function(e,r){var a="<div id='zp-Entry-"+r.key+"' class='zp-Entry zpSearchResultsItem hidden'>\n";o&&r.hasOwnProperty("image")&&(a+="<div id='zp-Citation-"+r.key+"' class='zp-Entry-Image hasImage' rel='"+r.key+"'>\n",a+="<img class='thumb' src='"+r.image[0]+"' alt='image' />\n",a+="</div>\x3c!-- .zp-Entry-Image --\x3e\n"),-1!=r.bib.indexOf("[1]")&&(r.bib=r.bib.replace("[1]","["+t+"]"),t++),a+=r.bib,(u||jQuery("input.tag[name=zpSearchFilters]:checked").length>0)&&r.data.tags.length>0&&(a+="<span class='item_key'>Tag(s): ",jQuery.each(r.data.tags,function(e,t){0!=e&&(a+=", "),a+=t.tag})),jQuery(".zpSearchResultsContainer").append(a+"</div>\x3c!-- .zp-Entry --\x3e\n"),jQuery(".zpSearchResultsPagingContainer").show()}),0!=p.content[2].request_next&&"false"!=p.content[2].request_next?(1==e?window.zpBrowseList[0].paginate(e,!1):window.zpBrowseList[0].paginate(e,!0),e=!1,s(!1,p.content[2].request_next,p.content[2].request_last),jQuery("input.zp-Zotpress-SearchBox-Input").autocomplete("option","source",n+a),jQuery("input.zp-Zotpress-SearchBox-Input").autocomplete("search")):(window.zpBrowseList[0].paginate(e,!0),e=!1))},open:function(){jQuery(".ui-autocomplete").hide()}})}});
